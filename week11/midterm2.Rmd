---
title: "exam2"
author: "Bruno Seo"
date: "8/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# 1
library(boot)
?poisons
poisons_model = lm(time ~ as.numeric(poison) + treat, data = poisons)

coef(poisons_model)
abs(coef(poisons_model)[2] - (3*coef(poisons_model)[2]+coef(poisons_model)[5]))
```

```{r}
# 2
library(boot)
poison_model_add = lm(time ~ poison + treat, data = poisons)
poison_model_int = lm(time ~ poison + treat + poison:treat, data = poisons)
anova(poison_model_add, poison_model_int)$"Pr(>F)"[2]


```

```{r}
# 3
x1 = -2
x2 = 4
x3 = 1
4.4*x3 + 6.3*x1*x3 + 7.9*x2*x3 + 8.2*x1*x2*x3


```

```{r}
# 4
library(boot)
poison_model_four = lm(time ~ poison + treat, data = poisons)

shapiro.test(resid(poison_model_four))

```

```{r}
# 5
sd = sqrt(7 + 2*4)
mean = 6 + 2*7 - 3*4

pnorm(5, mean, sd, lower.tail = FALSE)
```

```{r}
# 6
library(MASS)
boston_model = lm(log(medv)~nox+lstat+I(lstat^2), data=Boston)
coef(boston_model)
```

```{r}
# 7
?Boston
boston_model_seven = lm(log(medv)~age+lstat+I(lstat^2), data=Boston)
exp(predict(boston_model_seven, newdata=data.frame(age=75, lstat=13)))
```

```{r}
# 8
airquality = na.omit(airquality)
fit = lm(Ozone ~ ., data = airquality)

sum(hatvalues(fit) > 2 * mean(hatvalues(fit)))
```

```{r}
# 9
airquality = na.omit(airquality)
fit = lm(Ozone ~ ., data = airquality)

cd = cooks.distance(fit)
min(cd[cd > 4/length(cd)])

```

```{r}
# 10
airquality = na.omit(airquality)
fit = lm(Ozone ~ ., data = airquality)

bic_model = step(fit, direction = "backward", k=log(length(fitted(fit))), trace=0)

sum(resid(bic_model)^2)
```

```{r}
# 11
airquality = na.omit(airquality)
fit = lm(Ozone ~ .*., data = airquality)

aic_model = step(fit, direction = "backward", trace=0)
summary(aic_model)$adj.r.squared
```

```{r}
# 12
library(MASS)
# unique(birthwt$low) => should be changed to factor
# unique(birthwt$smoke)
birth_model =  glm(low~age+lwt+smoke, data=birthwt, family="binomial")
coef(birth_model)[3]
```

```{r}
# 13
birth_model =  glm(low~age+lwt+smoke, data=birthwt, family="binomial")

summary(birth_model)$coefficients[4,4]

```

```{r}
# 14
birth_model =  glm(low~age+lwt+smoke, data=birthwt, family="binomial")

predict(birth_model, newdata=data.frame(age=25, lwt=140, smoke=0), type='response')
```


```{r}
# 15
null_model = glm(low~age, data=birthwt, family="binomial")
birth_model =  glm(low~age+lwt+smoke, data=birthwt, family="binomial")

anova(null_model, birth_model, test="LRT")$"Pr(>Chi)"[2]

```

