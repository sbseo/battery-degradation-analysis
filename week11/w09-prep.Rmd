---
title: "w9-exam practice"
author: "Bruno Seo"
date: "7/31/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Practice quiz

```{r}
# 1
y = c( 2.16970226, 0.08154949, 1.87436461, 2.18945162, 2.22309978, 2.41426059, 1.05909087, 1.25968755, 1.63253137, 1.11420060, 0.66401090, 2.81256035, 2.81788591, 0.04363744,-0.14432369, 1.84278885, 1.06077328, 1.17791292,-0.15880343, 0.62306940, 3.00157708, 1.29147048, 2.56913997, 3.78205315, 1.35831961,-0.97666699, 2.43718042, 3.53070390, 3.47319198, 0.96164851, 1.43681202, 1.54669374, 0.28253818, 1.29221691, 1.48331236, 0.90402036, 3.77774829, 1.28241846, 1.69684421, 2.01613802, 0.75579181, 1.12367345, 2.08492597, 1.66349490,-0.06676333, 2.26927372, 1.21422931, 1.15355279, 0.97449010, 1.87477322)
x1 = c( 0.914806043, 0.937075413, 0.286139535, 0.830447626, 0.641745519, 0.519095949, 0.736588315, 0.134666597, 0.656992290, 0.705064784, 0.457741776, 0.719112252, 0.934672247, 0.255428824, 0.462292823, 0.940014523, 0.978226428, 0.117487362, 0.474997082, 0.560332746, 0.904031387, 0.138710168, 0.988891729, 0.946668233, 0.082437558, 0.514211784, 0.390203467, 0.905738131, 0.446969628, 0.836004260, 0.737595618, 0.811055141, 0.388108283, 0.685169729, 0.003948339, 0.832916080, 0.007334147, 0.207658973, 0.906601408, 0.611778643, 0.379559241, 0.435771585, 0.037431033, 0.973539914, 0.431751249, 0.957576597, 0.887754906, 0.639978769, 0.970966610, 0.618838207)
x2=c(  0.3334272113,   0.3467482482,   0.3984854114,   0.7846927757,   0.0389364911,   0.7487953862,   0.6772768302,   0.1712643304,   0.2610879638,  0.5144129347,  0.6756072745,  0.9828171979,  0.7595442676,  0.5664884241,  0.8496897186,  0.1894739354,  0.2712866147,  0.8281584852,  0.6932048204,  0.2405447396,  0.0429887960,  0.1404790941,  0.2163854151,  0.4793985642,  0.1974103423,  0.7193558377,  0.0078847387,  0.3754899646,  0.5144077083,  0.0015705542,  0.5816040025,  0.1579052082,  0.3590283059,  0.6456318784,  0.7758233626,  0.5636468416,  0.2337033986,  0.0899805163,  0.0856120649,  0.3052183695,  0.6674265147,  0.0002388966,  0.2085699569,  0.9330341273,  0.9256447486,  0.7340943010,  0.3330719834,  0.5150633298,  0.7439746463,  0.6191592400)
x3=c(0.626245345,0.217157698,0.216567311,0.388945029,0.942455692,0.962608014,0.739855279,0.733245906,0.535761290,0.002272966,0.608937453,0.836801559,0.751522563,0.452731573,0.535789994,0.537376695,0.001380844,0.355665954,0.612133090,0.828942131,0.356721999,0.410635126,0.573475899,0.589678304,0.719657292,0.394973045,0.919203929,0.962570294,0.233523526,0.724497600,0.903634525,0.603474085,0.631507299,0.937385850,0.850482751,0.579820899,0.821403924,0.113718609,0.764507759,0.623613457,0.148446607,0.080264467,0.464069551,0.779368161,0.733527960,0.817230444,0.170162481,0.944720326,0.293623841,0.149072052)
x4=c( 0.71937859, 0.32408595, 0.77880950, 0.39444100, 0.67859287, 0.77582504, 0.18786904, 0.02908582, 0.13571380, 0.68016418, 0.93482295, 0.55049408, 0.60176624, 0.19699449, 0.53523661, 0.17955574, 0.45188649, 0.31705335, 0.11617467, 0.18610216, 0.72973010, 0.41187207, 0.41404968, 0.48031013, 0.42749447, 0.13649036, 0.82467941, 0.59230424, 0.79439698, 0.76903243, 0.91805642, 0.86262978, 0.31697524, 0.25926058, 0.74226645, 0.74736112, 0.91790403, 0.79319121, 0.13332962, 0.28774975, 0.19467614, 0.78410938, 0.12887216, 0.12908928, 0.07225311, 0.05312948, 0.53187444, 0.11230824, 0.74318772, 0.73131548)
x5 = c( 0.77942686, 0.37632351, 0.72864907, 0.48686510, 0.64525420, 0.78110073, 0.16675625, 0.02296831, 0.14512345, 0.68612223, 0.93356833, 0.55589772, 0.57749447, 0.17178363, 0.45218166, 0.16043905, 0.42625398, 0.45214790, 0.04806886, 0.19296497, 0.65504884, 0.33835028, 0.42028480, 0.43047817, 0.42740333, 0.11507742, 0.79399583, 0.49107035, 0.73315958, 0.77800825, 0.94643745, 0.83798591, 0.31697838, 0.31540506, 0.81425924, 0.69250543, 0.91203806, 0.85326613, 0.10984314, 0.28512628, 0.19037078, 0.73972543, 0.10663796, 0.12761704, 0.05155967, 0.10879878, 0.50782479, 0.09064979, 0.77803085, 0.67849706)
x6 = c(0.483768142, 0.444569528, 0.060385590, 0.327506022, 0.878429047, 0.930604886, 0.392178457, 0.158846775, 0.319947601, 0.306965620, 0.107811254, 0.979334303, 0.496903428, 0.093074672, 0.211773658, 0.930500746, 0.296846407, 0.653218249, 0.901070478, 0.990795793, 0.430333221, 0.393776922, 0.141908895, 0.279806696, 0.564822223, 0.935139505, 0.358400145, 0.842007181, 0.722409214, 0.750735989, 0.923988452, 0.002378107, 0.160429915, 0.399272951, 0.675319577, 0.480372016, 0.533828781, 0.316950157, 0.814757590, 0.292219521, 0.409132091, 0.090918308, 0.798596638, 0.359785250, 0.040487577, 0.041086340, 0.954434238, 0.373341245, 0.806419668, 0.910059009)
quiz_data = data.frame(y,x1,x2,x3,x4,x5,x6)

model_add = lm(y~. -x1, data=quiz_data)
model_small = lm(x1~. -y -x1, data=quiz_data)
cor(resid(model_small), resid(model_add))
```

```{r}
# 2
library(car)
model_add = lm(y~., data=quiz_data)
vif(model_add)[5]

model_x5 = lm(x5~. -y -x5, data=quiz_data)
r_sq = summary(model_x5)$r.squared
1 / (1-r_sq)
```

```{r}
# 3
model_add = lm(y~., data=quiz_data)
model_three = lm(y~x1+x2+x3, data=quiz_data)

AIC(model_add, model_three)
sum(resid(model_add)^2)

```

```{r}
# 4
model_124 = lm(y~x1+x2+x4, data=quiz_data)
model_3456 = lm(y~x3+x4+x5+x6, data=quiz_data)

summary(model_124)$adj.r.squared
summary(model_3456)$adj.r.squared
```

```{r}
# 5
model_add = lm(y~., data=quiz_data)
aic_model = step(model_add, direction='backward', trace=0)

rsme = function(model){
  sqrt(mean((resid(model) / (1-hatvalues(model)))^2))
}
rsme(aic_model)
```


# Quiz

```{r}
# 1
?mtcars
library(car)
car_model = lm(mpg~., data=mtcars)
max(vif(car_model))
```


```{r}
# 2
car_model = lm(mpg~., data=mtcars)
summary(car_model)$adj.r.squared
```


```{r}
# 3
rsme = function(model){
  sqrt(mean((resid(model) / (1-hatvalues(model)))^2))
}

rsme(car_model)
```

```{r}
# 4
aic_model = step(car_model, direction="backward", trace=0)
```

```{r}
# 5
rsme(aic_model)
```

```{r}
# 6
max(vif(aic_model))
```

```{r}
# 7
# predicting is better and does not have collinearity issue. (vif lower than 5)
```

```{r}
# 8
init_model = lm(mpg~1, data=mtcars)
bic_model = step(init_model, scope=mpg~cyl+disp+hp+drat+wt+qsec+vs+am+gear+carb, direction = 'forward', k = log(length(fitted(car_model))), trace=0)
bic_model
```

```{r}
# 9
rsme(bic_model)
```

```{r}
# 10
?LifeCycleSavings

init_model = lm(sr~. -ddpi, data=LifeCycleSavings)
interest_model = lm(ddpi~. -sr -ddpi, data=LifeCycleSavings)
cor(resid(init_model), resid(interest_model))
```

```{r}
# 11
life_model_twoway = lm(sr~.^2, data=LifeCycleSavings)
summary(life_model_twoway)$adj.r.squared
```

```{r}
# 12
bic_model = step(life_model_twoway, direction="backward", k = log(length(fitted(life_model_twoway))), trace=0)

bic_model
```

```{r}
# 13
aic_model = step(life_model_twoway, direction = "backward", trace=0)
aic_model
```

```{r}
# 14
life_model_add = lm(sr~., data=LifeCycleSavings)

min(
rsme(life_model_twoway) ,
rsme(aic_model) ,
rsme(life_model_add)
)
```

```{r}
# 15
max(
summary(life_model_twoway)$adj.r.squared,
summary(aic_model)$adj.r.squared,
summary(life_model_add)$adj.r.squared
)
```


